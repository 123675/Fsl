/truba/home/obbaran/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
2018-12-04 22:46:22,950 - algorithms.Algorithm - INFO   - Algorithm options {'data_train_opt': {'nKnovel': 0, 'nKbase': 64, 'nExemplars': 0, 'nTestNovel': 0, 'nTestBase': 32, 'batch_size': 8, 'epoch_size': 8000}, 'data_test_opt': {'nKnovel': 5, 'nKbase': 64, 'nExemplars': 1, 'nTestNovel': 75, 'nTestBase': 75, 'batch_size': 1, 'epoch_size': 2000}, 'max_num_epochs': 60, 'networks': {'feat_model': {'def_file': 'architectures/ConvNet.py', 'pretrained': None, 'opt': {'userelu': False, 'in_planes': 3, 'out_planes': [64, 64, 128, 128], 'num_stages': 4}, 'optim_params': {'optim_type': 'sgd', 'lr': 0.1, 'momentum': 0.9, 'weight_decay': 0.0005, 'nesterov': True, 'LUT_lr': [(20, 0.1), (40, 0.006), (50, 0.0012), (60, 0.00024)]}}, 'classifier': {'def_file': 'architectures/ClassifierWithFewShotGenerationModule.py', 'pretrained': None, 'opt': {'classifier_type': 'cosine', 'weight_generator_type': 'none', 'nKall': 64, 'nFeat': 3200, 'scale_cls': 10}, 'optim_params': {'optim_type': 'sgd', 'lr': 0.1, 'momentum': 0.9, 'weight_decay': 0.0005, 'nesterov': True, 'LUT_lr': [(20, 0.1), (40, 0.006), (50, 0.0012), (60, 0.00024)]}}}, 'criterions': {'loss': {'ctype': 'CrossEntropyLoss', 'opt': None}}, 'algorithm_type': 'FewShot', 'exp_dir': './experiments/miniImageNet_Conv128CosineClassifier', 'disp_step': 200}
2018-12-04 22:46:22,951 - algorithms.Algorithm - INFO   - Set network feat_model
2018-12-04 22:46:22,952 - algorithms.Algorithm - INFO   - ==> Initiliaze network feat_model from file architectures/ConvNet.py with opts: {'userelu': False, 'in_planes': 3, 'out_planes': [64, 64, 128, 128], 'num_stages': 4}
2018-12-04 22:46:22,961 - algorithms.Algorithm - INFO   - Set network classifier
2018-12-04 22:46:22,961 - algorithms.Algorithm - INFO   - ==> Initiliaze network classifier from file architectures/ClassifierWithFewShotGenerationModule.py with opts: {'classifier_type': 'cosine', 'weight_generator_type': 'none', 'nKall': 64, 'nFeat': 3200, 'scale_cls': 10}
2018-12-04 22:46:22,964 - algorithms.Algorithm - INFO   - Initialize criterion[loss]: CrossEntropyLoss with options: None
2018-12-04 22:46:25,733 - algorithms.Algorithm - INFO   - Initialize optimizer: sgd with params: {'optim_type': 'sgd', 'lr': 0.1, 'momentum': 0.9, 'weight_decay': 0.0005, 'nesterov': True, 'LUT_lr': [(20, 0.1), (40, 0.006), (50, 0.0012), (60, 0.00024)]} for netwotk: feat_model
2018-12-04 22:46:25,733 - algorithms.Algorithm - INFO   - Initialize optimizer: sgd with params: {'optim_type': 'sgd', 'lr': 0.1, 'momentum': 0.9, 'weight_decay': 0.0005, 'nesterov': True, 'LUT_lr': [(20, 0.1), (40, 0.006), (50, 0.0012), (60, 0.00024)]} for netwotk: classifier
2018-12-04 22:46:25,733 - algorithms.Algorithm - INFO   - Training epoch [  1 /  60]
2018-12-04 22:46:25,733 - algorithms.Algorithm - INFO   - ==> Set to feat_model optimizer lr = 0.1000000000
2018-12-04 22:46:25,733 - algorithms.Algorithm - INFO   - ==> Set to classifier optimizer lr = 0.1000000000
2018-12-04 22:46:25,733 - algorithms.Algorithm - INFO   - Training: miniImageNet_Conv128CosineClassifier
  0%|          | 0/1000 [00:00<?, ?it/s]Launching experiment: ./config/miniImageNet_Conv128CosineClassifier.py
Loading experiment miniImageNet_Conv128CosineClassifier from file: ./config/miniImageNet_Conv128CosineClassifier.py
Generated logs, snapshots, and model files will be stored on ./experiments/miniImageNet_Conv128CosineClassifier
Loading mini ImageNet dataset - phase train
Loading mini ImageNet dataset - phase val
###################################dataset train =  (38400, 84, 84, 3)
  0%|          | 1/1000 [00:00<15:58,  1.04it/s]  0%|          | 3/1000 [00:01<11:24,  1.46it/s]  0%|          | 5/1000 [00:01<08:14,  2.01it/s]  1%|          | 7/1000 [00:01<06:00,  2.75it/s]  1%|          | 9/1000 [00:01<04:27,  3.70it/s]  1%|          | 11/1000 [00:01<03:22,  4.89it/s]  1%|▏         | 13/1000 [00:01<02:36,  6.30it/s]  2%|▏         | 15/1000 [00:01<02:04,  7.89it/s]  2%|▏         | 17/1000 [00:01<01:42,  9.60it/s]  2%|▏         | 19/1000 [00:01<01:26, 11.29it/s]  2%|▏         | 21/1000 [00:02<01:15, 12.90it/s]  2%|▏         | 23/1000 [00:02<01:08, 14.32it/s]  2%|▎         | 25/1000 [00:02<01:02, 15.54it/s]  3%|▎         | 27/1000 [00:02<00:59, 16.48it/s]  3%|▎         | 29/1000 [00:02<00:56, 17.26it/s]  3%|▎         | 31/1000 [00:02<00:54, 17.81it/s]  3%|▎         | 33/1000 [00:02<00:53, 18.24it/s]  4%|▎         | 35/1000 [00:02<00:52, 18.50it/s]  4%|▎         | 37/1000 [00:02<00:51, 18.74it/s]  4%|▍         | 39/1000 [00:02<00:50, 18.89it/s]  4%|▍         | 41/1000 [00:03<00:50, 19.01it/s]  4%|▍         | 43/1000 [00:03<00:50, 19.12it/s]  4%|▍         | 45/1000 [00:03<00:49, 19.18it/s]  5%|▍         | 47/1000 [00:03<00:49, 19.18it/s]  5%|▍         | 49/1000 [00:03<00:49, 19.22it/s]  5%|▌         | 51/1000 [00:03<00:49, 19.27it/s]  5%|▌         | 53/1000 [00:03<00:49, 19.27it/s]  6%|▌         | 55/1000 [00:03<00:49, 19.23it/s]  6%|▌         | 57/1000 [00:03<00:48, 19.30it/s]  6%|▌         | 59/1000 [00:03<00:48, 19.29it/s]  6%|▌         | 61/1000 [00:04<00:48, 19.25it/s]  6%|▋         | 63/1000 [00:04<00:48, 19.30it/s]  6%|▋         | 65/1000 [00:04<00:48, 19.29it/s]  7%|▋         | 67/1000 [00:04<00:48, 19.26it/s]  7%|▋         | 69/1000 [00:04<00:48, 19.31it/s]  7%|▋         | 71/1000 [00:04<00:48, 19.30it/s]  7%|▋         | 73/1000 [00:04<00:47, 19.32it/s]  8%|▊         | 75/1000 [00:04<00:47, 19.28it/s]  8%|▊         | 77/1000 [00:04<00:47, 19.30it/s]  8%|▊         | 79/1000 [00:05<00:47, 19.28it/s]  8%|▊         | 81/1000 [00:05<00:47, 19.26it/s]  8%|▊         | 83/1000 [00:05<00:47, 19.29it/s]  8%|▊         | 85/1000 [00:05<00:47, 19.29it/s]  9%|▊         | 87/1000 [00:05<00:47, 19.25it/s]  9%|▉         | 89/1000 [00:05<00:47, 19.30it/s]  9%|▉         | 91/1000 [00:05<00:47, 19.29it/s]  9%|▉         | 93/1000 [00:05<00:47, 19.14it/s] 10%|▉         | 95/1000 [00:05<00:47, 19.19it/s] 10%|▉         | 97/1000 [00:05<00:46, 19.22it/s] 10%|▉         | 99/1000 [00:06<00:46, 19.20it/s] 10%|█         | 101/1000 [00:06<00:46, 19.27it/s] 10%|█         | 103/1000 [00:06<00:46, 19.26it/s] 10%|█         | 105/1000 [00:06<00:46, 19.24it/s] 11%|█         | 107/1000 [00:06<00:46, 19.25it/s] 11%|█         | 109/1000 [00:06<00:46, 19.26it/s] 11%|█         | 111/1000 [00:06<00:46, 19.24it/s] 11%|█▏        | 113/1000 [00:06<00:45, 19.28it/s] 12%|█▏        | 115/1000 [00:06<00:45, 19.28it/s] 12%|█▏        | 117/1000 [00:06<00:45, 19.26it/s] 12%|█▏        | 119/1000 [00:07<00:45, 19.29it/s] 12%|█▏        | 121/1000 [00:07<00:45, 19.29it/s] 12%|█▏        | 123/1000 [00:07<00:45, 19.28it/s] 12%|█▎        | 125/1000 [00:07<00:45, 19.25it/s] 13%|█▎        | 127/1000 [00:07<00:45, 19.26it/s] 13%|█▎        | 129/1000 [00:07<00:45, 19.30it/s] 13%|█▎        | 131/1000 [00:07<00:45, 19.28it/s] 13%|█▎        | 133/1000 [00:07<00:44, 19.28it/s] 14%|█▎        | 135/1000 [00:07<00:44, 19.26it/s] 14%|█▎        | 137/1000 [00:08<00:44, 19.26it/s] 14%|█▍        | 139/1000 [00:08<00:44, 19.30it/s] 14%|█▍        | 141/1000 [00:08<00:44, 19.27it/s] 14%|█▍        | 143/1000 [00:08<00:44, 19.25it/s] 14%|█▍        | 145/1000 [00:08<00:44, 19.30it/s] 15%|█▍        | 147/1000 [00:08<00:44, 19.28it/s] 15%|█▍        | 149/1000 [00:08<00:44, 19.28it/s] 15%|█▌        | 151/1000 [00:08<00:44, 19.25it/s] 15%|█▌        | 153/1000 [00:08<00:43, 19.27it/s] 16%|█▌        | 155/1000 [00:08<00:43, 19.28it/s] 16%|█▌        | 157/1000 [00:09<00:43, 19.26it/s] 16%|█▌        | 159/1000 [00:09<00:43, 19.27it/s] 16%|█▌        | 161/1000 [00:09<00:43, 19.26it/s] 16%|█▋        | 163/1000 [00:09<00:43, 19.24it/s] 16%|█▋        | 165/1000 [00:09<00:43, 19.30it/s] 17%|█▋        | 167/1000 [00:09<00:43, 19.29it/s] 17%|█▋        | 169/1000 [00:09<00:43, 19.26it/s] 17%|█▋        | 171/1000 [00:09<00:43, 19.28it/s] 17%|█▋        | 173/1000 [00:09<00:42, 19.30it/s] 18%|█▊        | 175/1000 [00:09<00:42, 19.25it/s] 18%|█▊        | 177/1000 [00:10<00:42, 19.27it/s] 18%|█▊        | 179/1000 [00:10<00:42, 19.29it/s] 18%|█▊        | 181/1000 [00:10<00:42, 19.25it/s] 18%|█▊        | 183/1000 [00:10<00:42, 19.24it/s] 18%|█▊        | 185/1000 [00:10<00:42, 19.25it/s] 19%|█▊        | 187/1000 [00:10<00:42, 19.22it/s] 19%|█▉        | 189/1000 [00:10<00:42, 19.23it/s] 19%|█▉        | 191/1000 [00:10<00:42, 19.24it/s] 19%|█▉        | 193/1000 [00:10<00:41, 19.22it/s] 20%|█▉        | 195/1000 [00:11<00:41, 19.24it/s] 20%|█▉        | 197/1000 [00:11<00:41, 19.24it/s] 20%|█▉        | 199/1000 [00:11<00:41, 19.21it/s]2018-12-04 22:46:37,028 - algorithms.Algorithm - INFO   - ==> Iteration [  1][ 200 / 1000]: {'loss': 3.0897}
 20%|██        | 201/1000 [00:11<00:41, 19.23it/s] 20%|██        | 203/1000 [00:11<00:41, 19.23it/s] 20%|██        | 205/1000 [00:11<00:41, 19.22it/s] 21%|██        | 207/1000 [00:11<00:41, 19.23it/s] 21%|██        | 209/1000 [00:11<00:41, 19.23it/s] 21%|██        | 211/1000 [00:11<00:41, 19.19it/s] 21%|██▏       | 213/1000 [00:11<00:40, 19.25it/s] 22%|██▏       | 215/1000 [00:12<00:40, 19.25it/s] 22%|██▏       | 217/1000 [00:12<00:40, 19.22it/s] 22%|██▏       | 219/1000 [00:12<00:40, 19.23it/s] 22%|██▏       | 221/1000 [00:12<00:40, 19.25it/s] 22%|██▏       | 223/1000 [00:12<00:40, 19.24it/s] 22%|██▎       | 225/1000 [00:12<00:40, 19.23it/s] 23%|██▎       | 227/1000 [00:12<00:40, 19.25it/s] 23%|██▎       | 229/1000 [00:12<00:40, 19.22it/s] 23%|██▎       | 231/1000 [00:12<00:39, 19.24it/s] 23%|██▎       | 233/1000 [00:13<00:39, 19.25it/s] 24%|██▎       | 235/1000 [00:13<00:39, 19.20it/s] 24%|██▎       | 237/1000 [00:13<00:39, 19.23it/s] 24%|██▍       | 239/1000 [00:13<00:39, 19.23it/s] 24%|██▍       | 241/1000 [00:13<00:39, 19.25it/s] 24%|██▍       | 243/1000 [00:13<00:39, 19.21it/s] 24%|██▍       | 245/1000 [00:13<00:39, 19.23it/s] 25%|██▍       | 247/1000 [00:13<00:39, 19.21it/s] 25%|██▍       | 249/1000 [00:13<00:39, 19.22it/s] 25%|██▌       | 251/1000 [00:13<00:38, 19.24it/s] 25%|██▌       | 253/1000 [00:14<00:38, 19.21it/s] 26%|██▌       | 255/1000 [00:14<00:38, 19.23it/s] 26%|██▌       | 257/1000 [00:14<00:38, 19.24it/s] 26%|██▌       | 259/1000 [00:14<00:38, 19.19it/s] 26%|██▌       | 261/1000 [00:14<00:38, 19.21it/s] 26%|██▋       | 263/1000 [00:14<00:38, 19.22it/s] 26%|██▋       | 265/1000 [00:14<00:38, 19.21it/s] 27%|██▋       | 267/1000 [00:14<00:38, 19.23it/s] 27%|██▋       | 269/1000 [00:14<00:38, 19.23it/s] 27%|██▋       | 271/1000 [00:14<00:38, 19.17it/s] 27%|██▋       | 273/1000 [00:15<00:37, 19.25it/s] 28%|██▊       | 275/1000 [00:15<00:37, 19.23it/s] 28%|██▊       | 277/1000 [00:15<00:37, 19.19it/s] 28%|██▊       | 279/1000 [00:15<00:37, 19.24it/s] 28%|██▊       | 281/1000 [00:15<00:37, 19.23it/s] 28%|██▊       | 283/1000 [00:15<00:37, 19.18it/s] 28%|██▊       | 285/1000 [00:15<00:37, 19.21it/s] 29%|██▊       | 287/1000 [00:15<00:37, 19.16it/s] 29%|██▉       | 289/1000 [00:15<00:37, 19.16it/s] 29%|██▉       | 291/1000 [00:16<00:36, 19.19it/s] 29%|██▉       | 293/1000 [00:16<00:36, 19.17it/s] 30%|██▉       | 295/1000 [00:16<00:36, 19.18it/s] 30%|██▉       | 297/1000 [00:16<00:36, 19.20it/s] 30%|██▉       | 299/1000 [00:16<00:36, 19.20it/s] 30%|███       | 301/1000 [00:16<00:36, 19.20it/s] 30%|███       | 303/1000 [00:16<00:36, 19.21it/s] 30%|███       | 305/1000 [00:16<00:36, 19.20it/s] 31%|███       | 307/1000 [00:16<00:36, 19.22it/s] 31%|███       | 309/1000 [00:16<00:35, 19.22it/s] 31%|███       | 311/1000 [00:17<00:35, 19.17it/s] 31%|███▏      | 313/1000 [00:17<00:35, 19.20it/s] 32%|███▏      | 315/1000 [00:17<00:35, 19.23it/s] 32%|███▏      | 317/1000 [00:17<00:35, 19.20it/s] 32%|███▏      | 319/1000 [00:17<00:35, 19.22it/s] 32%|███▏      | 321/1000 [00:17<00:35, 19.17it/s] 32%|███▏      | 323/1000 [00:17<00:35, 19.20it/s] 32%|███▎      | 325/1000 [00:17<00:35, 19.21it/s] 33%|███▎      | 327/1000 [00:17<00:35, 19.22it/s] 33%|███▎      | 329/1000 [00:18<00:34, 19.20it/s] 33%|███▎      | 331/1000 [00:18<00:34, 19.22it/s] 33%|███▎      | 333/1000 [00:18<00:34, 19.22it/s] 34%|███▎      | 335/1000 [00:18<00:34, 19.23it/s] 34%|███▎      | 337/1000 [00:18<00:34, 19.22it/s] 34%|███▍      | 339/1000 [00:18<00:34, 18.99it/s] 34%|███▍      | 341/1000 [00:18<00:34, 19.06it/s] 34%|███▍      | 343/1000 [00:18<00:34, 19.02it/s] 34%|███▍      | 345/1000 [00:18<00:34, 19.07it/s] 35%|███▍      | 347/1000 [00:18<00:34, 19.09it/s] 35%|███▍      | 349/1000 [00:19<00:34, 19.06it/s] 35%|███▌      | 351/1000 [00:19<00:34, 19.08it/s] 35%|███▌      | 353/1000 [00:19<00:33, 19.11it/s] 36%|███▌      | 355/1000 [00:19<00:33, 19.15it/s] 36%|███▌      | 357/1000 [00:19<00:33, 19.16it/s] 36%|███▌      | 359/1000 [00:19<00:33, 19.19it/s] 36%|███▌      | 361/1000 [00:19<00:33, 19.19it/s] 36%|███▋      | 363/1000 [00:19<00:33, 19.20it/s] 36%|███▋      | 365/1000 [00:19<00:33, 19.11it/s] 37%|███▋      | 367/1000 [00:19<00:33, 19.18it/s] 37%|███▋      | 369/1000 [00:20<00:32, 19.17it/s] 37%|███▋      | 371/1000 [00:20<00:32, 19.20it/s] 37%|███▋      | 373/1000 [00:20<00:32, 19.20it/s] 38%|███▊      | 375/1000 [00:20<00:32, 19.06it/s] 38%|███▊      | 377/1000 [00:20<00:32, 19.03it/s] 38%|███▊      | 379/1000 [00:20<00:32, 19.03it/s] 38%|███▊      | 381/1000 [00:20<00:32, 18.83it/s] 38%|███▊      | 383/1000 [00:20<00:32, 18.83it/s] 38%|███▊      | 385/1000 [00:20<00:32, 18.98it/s] 39%|███▊      | 387/1000 [00:21<00:32, 19.01it/s] 39%|███▉      | 389/1000 [00:21<00:32, 19.02it/s] 39%|███▉      | 391/1000 [00:21<00:31, 19.03it/s] 39%|███▉      | 393/1000 [00:21<00:31, 19.06it/s]slurmstepd: error: *** JOB 609758 ON akya3 CANCELLED AT 2018-12-04T22:46:47 ***
