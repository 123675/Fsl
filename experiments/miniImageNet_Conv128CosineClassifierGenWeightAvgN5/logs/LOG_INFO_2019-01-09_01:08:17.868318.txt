2019-01-09 01:08:17,870 - algorithms.Algorithm - INFO   - Algorithm options {'data_train_opt': {'nKnovel': 5, 'nKbase': -1, 'nExemplars': 5, 'nTestNovel': 15, 'nTestBase': 15, 'batch_size': 8, 'epoch_size': 8000}, 'data_test_opt': {'nKnovel': 5, 'nKbase': 64, 'nExemplars': 5, 'nTestNovel': 75, 'nTestBase': 75, 'batch_size': 1, 'epoch_size': 2000}, 'max_num_epochs': 60, 'networks': {'feat_model': {'def_file': 'architectures/ConvNet.py', 'pretrained': './experiments/miniImageNet_Conv128CosineClassifier/feat_model_net_epoch*.best', 'opt': {'userelu': False, 'in_planes': 3, 'out_planes': [64, 64, 128, 128], 'num_stages': 4}, 'optim_params': None}, 'classifier': {'def_file': 'architectures/ClassifierWithFewShotGenerationModule.py', 'pretrained': './experiments/miniImageNet_Conv128CosineClassifier/classifier_net_epoch*.best', 'opt': {'classifier_type': 'cosine', 'weight_generator_type': 'feature_averaging', 'nKall': 64, 'nFeat': 3200, 'scale_cls': 10}, 'optim_params': {'optim_type': 'sgd', 'lr': 0.1, 'momentum': 0.9, 'weight_decay': 0.0005, 'nesterov': True, 'LUT_lr': [(20, 0.1), (40, 0.006), (50, 0.0012), (60, 0.00024)]}}}, 'criterions': {'loss': {'ctype': 'CrossEntropyLoss', 'opt': None}}, 'algorithm_type': 'FewShot', 'exp_dir': './experiments/miniImageNet_Conv128CosineClassifierGenWeightAvgN5'}
2019-01-09 01:08:17,871 - algorithms.Algorithm - INFO   - Set network feat_model
2019-01-09 01:08:17,871 - algorithms.Algorithm - INFO   - ==> Initiliaze network feat_model from file architectures/ConvNet.py with opts: {'userelu': False, 'in_planes': 3, 'out_planes': [64, 64, 128, 128], 'num_stages': 4}
2019-01-09 01:08:17,879 - algorithms.Algorithm - INFO   - ==> Load pretrained parameters from file ./experiments/miniImageNet_Conv128CosineClassifier/feat_model_net_epoch1.best:
2019-01-09 01:08:19,903 - algorithms.Algorithm - INFO   - Set network classifier
2019-01-09 01:08:19,903 - algorithms.Algorithm - INFO   - ==> Initiliaze network classifier from file architectures/ClassifierWithFewShotGenerationModule.py with opts: {'classifier_type': 'cosine', 'weight_generator_type': 'feature_averaging', 'nKall': 64, 'nFeat': 3200, 'scale_cls': 10}
2019-01-09 01:08:19,907 - algorithms.Algorithm - INFO   - ==> Load pretrained parameters from file ./experiments/miniImageNet_Conv128CosineClassifier/classifier_net_epoch1.best:
2019-01-09 01:08:19,909 - algorithms.Algorithm - INFO   - ==> WARNING: network parameters in pre-trained file ./experiments/miniImageNet_Conv128CosineClassifier/classifier_net_epoch1.best do not strictly match
2019-01-09 01:08:19,910 - algorithms.Algorithm - INFO   - ==> Copying parameter weight_base from file ./experiments/miniImageNet_Conv128CosineClassifier/classifier_net_epoch1.best
2019-01-09 01:08:19,910 - algorithms.Algorithm - INFO   - ==> Copying parameter bias from file ./experiments/miniImageNet_Conv128CosineClassifier/classifier_net_epoch1.best
2019-01-09 01:08:19,910 - algorithms.Algorithm - INFO   - ==> Copying parameter scale_cls from file ./experiments/miniImageNet_Conv128CosineClassifier/classifier_net_epoch1.best
2019-01-09 01:08:19,910 - algorithms.Algorithm - INFO   - Initialize criterion[loss]: CrossEntropyLoss with options: None
2019-01-09 01:08:19,911 - algorithms.Algorithm - INFO   - Load checkpoint of epoch *
2019-01-09 01:08:19,913 - algorithms.Algorithm - INFO   - Load checkpoint of most recent epoch 22
2019-01-09 01:08:19,913 - algorithms.Algorithm - INFO   - Loading ./experiments/miniImageNet_Conv128CosineClassifierGenWeightAvgN5/classifier_net_epoch22.best for network classifier
2019-01-09 01:08:19,946 - algorithms.Algorithm - INFO   - Evaluating: miniImageNet_Conv128CosineClassifierGenWeightAvgN5
2019-01-09 01:08:19,947 - algorithms.Algorithm - INFO   - ==> Dataset: MiniImageNet_val [2000 batches]
2019-01-09 01:09:40,676 - algorithms.Algorithm - INFO   - ==> Results: {'loss': 1.8966, 'AccuracyNovel_cnf': 0.3773}
